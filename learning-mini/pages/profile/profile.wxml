<!--pages/profile/profile.wxml-->
<view class="container">
  <!-- 用户信息 -->
  <view class="profile-card card" wx:if="{{userInfo}}">
    <image class="profile-avatar" src="{{userInfo.avatarUrl}}" mode="aspectFill"></image>
    <text class="profile-name">{{userInfo.nickName}}</text>
    <view class="profile-stats">
      <view class="stat-item">
        <text class="stat-value">{{score}}</text>
        <text class="stat-label">总积分</text>
      </view>
      <view class="stat-divider"></view>
      <view class="stat-item">
        <text class="stat-value">{{coins}}</text>
        <text class="stat-label">金币</text>
      </view>
      <view class="stat-divider"></view>
      <view class="stat-item">
        <text class="stat-value">{{learnedCount}}</text>
        <text class="stat-label">已学单词</text>
      </view>
    </view>
  </view>
  
  <!-- 未登录 -->
  <view class="login-card card" wx:else>
    <view class="login-header">
      <text class="login-title">完善个人信息</text>
      <text class="login-subtitle">登录后同步学习进度</text>
    </view>
    
    <view class="avatar-section">
      <button class="avatar-wrapper" open-type="chooseAvatar" bind:chooseavatar="onChooseAvatar">
        <image wx:if="{{tempAvatarUrl}}" class="avatar-preview" src="{{tempAvatarUrl}}" mode="aspectFill"></image>
        <view wx:else class="avatar-placeholder">
          <text class="avatar-placeholder-icon">👤</text>
        </view>
        <view class="avatar-edit-icon">📷</view>
      </button>
      <text class="avatar-tip">点击选择头像</text>
    </view>
    
    <view class="input-group">
      <text class="input-label">昵称</text>
      <input type="nickname" class="nickname-input" placeholder="点击输入昵称" bind:change="onNicknameChange" bindblur="onNicknameChange" bindinput="onNicknameInput" value="{{tempNickname}}"/>
    </view>

    <button class="btn-primary" bindtap="submitLogin" disabled="{{!tempAvatarUrl || !tempNickname}}">保存并登录</button>
  </view>
  
  <!-- 功能菜单 -->
  <view class="menu-list">
    <view class="menu-item" bindtap="goToPage" data-page="mistakes">
      <text class="menu-icon">📝</text>
      <text class="menu-text">错题本</text>
      <text class="menu-badge" wx:if="{{mistakesCount > 0}}">{{mistakesCount}}</text>
      <text class="menu-arrow">›</text>
    </view>
    <view class="menu-item" bindtap="goToPage" data-page="stats">
      <text class="menu-icon">📊</text>
      <text class="menu-text">学习统计</text>
      <text class="menu-arrow">›</text>
    </view>
    <view class="menu-item" bindtap="goToPage" data-page="settings">
      <text class="menu-icon">⚙️</text>
      <text class="menu-text">设置</text>
      <text class="menu-arrow">›</text>
    </view>
    <view class="menu-item" bindtap="goToPage" data-page="about">
      <text class="menu-icon">ℹ️</text>
      <text class="menu-text">关于我们</text>
      <text class="menu-arrow">›</text>
    </view>
  </view>
  
  <!-- 退出登录 -->
  <button class="logout-btn" wx:if="{{userInfo}}" bindtap="handleLogout">退出登录</button>
</view>
